const cityId=$argument;const apiUrl=`http://t.weather.sojson.com/api/weather/city/${cityId}`;$httpClient.get(apiUrl,(error,response,data)=>{if(error){console.log(error);$notification.post('è·å–å¤©æ°”å¤±è´¥','','è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•');$done();return;}
const weatherData=JSON.parse(data);if(weatherData.status!==200){console.log(`è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š${weatherData.status}`);$notification.post('è·å–å¤©æ°”å¤±è´¥','','è¯·å¡«å†™æ­£ç¡®çš„cityId');$done();return;}
const cityInfo=weatherData.cityInfo;const currentWeather=weatherData.data.forecast[0];const message=`ğŸ“åŸå¸‚ï¼š${cityInfo.city}\nğŸ•°ï¸æ›´æ–°æ—¶é—´ï¼š${cityInfo.updateTime} \nğŸŒ¤ï¸å¤©æ°”ï¼š${currentWeather.type}\nğŸŒ¡ï¸æ¸©åº¦ï¼š${currentWeather.low}  ${currentWeather.high}\nğŸ’§æ¹¿åº¦ï¼š${weatherData.data.shidu}\nğŸ’¨ç©ºæ°”è´¨é‡ï¼š${weatherData.data.quality}\nâ˜ï¸PM2.5ï¼š${weatherData.data.pm25}\nâ˜ï¸PM10ï¼š${weatherData.data.pm10}\nğŸªé£å‘ï¼š${currentWeather.fx}\nğŸŒªï¸é£åŠ›ï¼š${currentWeather.fl}\nğŸŒ…æ—¥å‡ºæ—¶é—´ï¼š${currentWeather.sunrise}\nğŸŒ‡æ—¥è½æ—¶é—´ï¼š${currentWeather.sunset}\nğŸ·ï¸Tipsï¼š${currentWeather.notice}`;$notification.post('å¤©æ°”é€šçŸ¥','',message);$done();});
